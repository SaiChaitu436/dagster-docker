{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-11-26T09:50:28.090596Z", "invocation_id": "b779f2b0-e761-4724-80df-8c5d42c77459", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-26T09:50:23.614266Z", "completed_at": "2024-11-26T09:50:23.663159Z"}, {"name": "execute", "started_at": "2024-11-26T09:50:23.665914Z", "completed_at": "2024-11-26T09:50:28.067673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.4600043296813965, "adapter_response": {"_message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 172, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "e13b4831-249c-4887-810d-1dd800df6734", "slot_ms": 21598}, "message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_offers", "compiled": true, "compiled_code": "WITH source_data AS (\n\n    SELECT \n\n        PARSE_JSON(data.message_body) AS raw_data\n\n    FROM \n\n        `dbt-437212`.`wellbefore`.`BuyBox_raw_ds_first20_entries` AS data\n\n),\n\nflatten_data AS (\n\n    SELECT\n\n        JSON_VALUE(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\n\n        JSON_VALUE(raw_data, \"$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\n\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offer\n\n    FROM source_data\n\n),\n\nflatten_data_1 AS (\n\n    SELECT\n\n        NotificationId,\n\n        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,\n\n        ASIN,\n\n        JSON_VALUE(offer, \"$.SellerId\") AS SellerId,\n\n        JSON_VALUE(offer, \"$.IsBuyBoxWinner\") AS IsBuyBoxWinner,\n\n        JSON_VALUE(offer, \"$.ListingPrice.Amount\") AS ListingPriceAmount,\n\n        JSON_VALUE(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\n\n        JSON_VALUE(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS IsOfferNationalPrime,\n\n        JSON_VALUE(offer, \"$.PrimeInformation.IsOfferPrime\") AS PrimeInformation\n\n    FROM flatten_data,\n\n    UNNEST(offer) AS offer\n\n)\n\n\n\nSELECT * \n\nFROM flatten_data_1", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`"}], "elapsed_time": 6.334269046783447, "args": {"introspect": true, "defer": false, "use_colors_file": true, "static_parser": true, "vars": {}, "populate_cache": true, "log_level": "info", "require_resource_names_without_spaces": false, "partial_parse": true, "log_format_file": "json", "favor_state": false, "log_level_file": "debug", "log_path": "/app/buy_box_gcp_1/target/3beca4a", "print": true, "exclude": [], "empty": false, "project_dir": "/app/buy_box_gcp_1", "send_anonymous_usage_stats": false, "partial_parse_file_diff": true, "select": ["src_offers"], "macro_debugging": false, "target_path": "target/3beca4a", "use_colors": true, "invocation_command": "dbt run --select src_offers", "quiet": false, "version_check": true, "indirect_selection": "eager", "log_file_max_bytes": 10485760, "strict_mode": false, "printer_width": 80, "source_freshness_run_project_hooks": false, "cache_selected_only": false, "which": "run", "write_json": true, "profiles_dir": "/app/buy_box_gcp_1", "enable_legacy_logger": false, "show_resource_report": false, "warn_error_options": {"include": [], "exclude": []}, "log_format": "json", "require_explicit_package_overrides_for_builtin_materializations": true}}