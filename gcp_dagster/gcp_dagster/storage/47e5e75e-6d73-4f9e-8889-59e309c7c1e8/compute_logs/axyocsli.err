2024-11-26 09:47:33 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - LOGS_CAPTURED - Started capturing logs in process (pid: 1280).
2024-11-26 09:47:33 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_START - Started execution of step "buy_box_gcp_1_dbt_assets".
2024-11-26 09:47:34 +0000 - dagster - INFO - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - buy_box_gcp_1_dbt_assets - A dbt subsetted execution is not being performed. Using the default dbt selection arguments `['--select', 'fqn:*']`.
2024-11-26 09:47:36 +0000 - dagster - INFO - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - buy_box_gcp_1_dbt_assets - Copying `/app/buy_box_gcp_1/target/partial_parse.msgpack` to `/app/buy_box_gcp_1/target/buy_box_gcp_1_dbt_assets-47e5e75-433377a/partial_parse.msgpack` to take advantage of partial parsing.
2024-11-26 09:47:36 +0000 - dagster - INFO - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - buy_box_gcp_1_dbt_assets - Running dbt command: `dbt build --select fqn:*`.
2024-11-26 09:47:47 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_dim_all_columns_1_month" of type "Nothing". (Type check passed).
2024-11-26 09:47:47 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value dim_all_columns_1_month.
2024-11-26 09:47:52 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_dim_offers_values" of type "Nothing". (Type check passed).
2024-11-26 09:47:53 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value dim_offers_values.
2024-11-26 09:47:54 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_dim_summary_values" of type "Nothing". (Type check passed).
2024-11-26 09:47:55 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value dim_summary_values.
2024-11-26 09:47:56 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_fct_sellers" of type "Nothing". (Type check passed).
2024-11-26 09:47:57 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value fct_sellers.
2024-11-26 09:48:01 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_src_buybox_offers" of type "Nothing". (Type check passed).
2024-11-26 09:48:01 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value src_buybox_offers.
2024-11-26 09:48:05 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_src_notification_lowest_prices" of type "Nothing". (Type check passed).
2024-11-26 09:48:06 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value src_notification_lowest_prices.
2024-11-26 09:48:10 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_src_notification_summary" of type "Nothing". (Type check passed).
2024-11-26 09:48:10 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value src_notification_summary.
2024-11-26 09:48:15 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_src_notifications" of type "Nothing". (Type check passed).
2024-11-26 09:48:15 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value src_notifications.
2024-11-26 09:48:19 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_src_offer_change_trigger" of type "Nothing". (Type check passed).
2024-11-26 09:48:19 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value src_offer_change_trigger.
2024-11-26 09:48:23 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_src_offers" of type "Nothing". (Type check passed).
2024-11-26 09:48:24 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value src_offers.
2024-11-26 09:48:28 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_src_products" of type "Nothing". (Type check passed).
2024-11-26 09:48:28 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value src_products.
2024-11-26 09:48:34 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_src_sales_ranking" of type "Nothing". (Type check passed).
2024-11-26 09:48:35 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value src_sales_ranking.
2024-11-26 09:48:39 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_src_shipping" of type "Nothing". (Type check passed).
2024-11-26 09:48:40 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value src_shipping.
2024-11-26 09:48:47 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "seed_buy_box_gcp_1_BuyBox_raw_ds_first20_entries" of type "Nothing". (Type check passed).
2024-11-26 09:48:48 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value BuyBox_raw_ds_first20_entries.
2024-11-26 09:48:53 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_OUTPUT - Yielded output "model_buy_box_gcp_1_variable_summary_table" of type "Nothing". (Type check passed).
2024-11-26 09:48:54 +0000 - dagster - DEBUG - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - ASSET_MATERIALIZATION - Materialized value variable_summary_table.
2024-11-26 09:48:54 +0000 - dagster - INFO - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - buy_box_gcp_1_dbt_assets - Finished dbt command: `dbt build --select fqn:*`.
2024-11-26 09:48:55 +0000 - dagster - ERROR - materialize_dbt_models - 47e5e75e-6d73-4f9e-8889-59e309c7c1e8 - 1280 - buy_box_gcp_1_dbt_assets - STEP_FAILURE - Execution of step "buy_box_gcp_1_dbt_assets" failed.

dagster_dbt.errors.DagsterDbtCliRuntimeError: The dbt CLI process with command

`dbt build --select fqn:*`

failed with exit code `1`. Check the stdout in the Dagster compute logs for the full information about the error, or view the dbt debug log: /app/buy_box_gcp_1/target/buy_box_gcp_1_dbt_assets-47e5e75-433377a/dbt.log.

Errors parsed from dbt logs:

1 of 17 ERROR creating sql view model wellbefore.dim_all_columns ............... [[31mERROR[0m in 0.11s]

BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-437212&j=bq:US:8a7660a9-13c8-46ad-b955-621c14ecb619&page=queryresults

3 of 17 ERROR creating sql view model wellbefore.dim_all_columns_using_join .... [[31mERROR[0m in 3.54s]

  Compilation Error in model dim_all_columns (models/dim/dim_all_columns.sql)
  Trying to create view `dbt-437212`.`wellbefore`.`dim_all_columns`, but it currently exists as a table. Either drop `dbt-437212`.`wellbefore`.`dim_all_columns` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/relations/view/replace.sql)
  > called by macro bigquery__create_or_replace_view (macros/relations/view/replace.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model dim_all_columns (models/dim/dim_all_columns.sql)

  Database Error in model dim_all_columns_using_join (models/dim/dim_all_columns_using_join.sql)
  CREATE VIEW has columns with duplicate name EventTime at [6:6]
  compiled code at target/buy_box_gcp_1_dbt_assets-47e5e75-433377a/run/buy_box_gcp_1/models/dim/dim_all_columns_using_join.sql

Stack Trace:
  File "/usr/local/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_plan.py", line 245, in dagster_event_sequence_for_step
    for step_event in check.generator(step_events):
  File "/usr/local/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_step.py", line 499, in core_dagster_event_sequence_for_step
    for user_event in _step_output_error_checked_user_event_sequence(
  File "/usr/local/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_step.py", line 183, in _step_output_error_checked_user_event_sequence
    for user_event in user_event_sequence:
  File "/usr/local/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_step.py", line 87, in _process_asset_results_to_events
    for user_event in user_event_sequence:
  File "/usr/local/lib/python3.10/site-packages/dagster/_core/execution/plan/compute.py", line 193, in execute_core_compute
    for step_output in _yield_compute_results(step_context, inputs, compute_fn, compute_context):
  File "/usr/local/lib/python3.10/site-packages/dagster/_core/execution/plan/compute.py", line 162, in _yield_compute_results
    for event in iterate_with_context(
  File "/usr/local/lib/python3.10/site-packages/dagster/_utils/__init__.py", line 482, in iterate_with_context
    next_output = next(iterator)
  File "/app/gcp_dagster/assets.py", line 9, in buy_box_gcp_1_dbt_assets
    yield from dbt.cli(["build"], context=context).stream()
  File "/usr/local/lib/python3.10/site-packages/dagster_dbt/core/dbt_event_iterator.py", line 203, in __next__
    return next(self._inner_iterator)
  File "/usr/local/lib/python3.10/site-packages/dagster_dbt/core/dbt_cli_invocation.py", line 274, in _stream_asset_events
    for event in self.stream_raw_events():
  File "/usr/local/lib/python3.10/site-packages/dagster_dbt/core/dbt_cli_invocation.py", line 367, in stream_raw_events
    self._raise_on_error()
  File "/usr/local/lib/python3.10/site-packages/dagster_dbt/core/dbt_cli_invocation.py", line 460, in _raise_on_error
    raise error

